library(data.table)
library(dplyr)
library(lubridate)
library(corrplot)
library(ggcorrplot)

df <- fread("/Users/kyosuke/Downloads/session_actions.csv")

df$step <- as.numeric(df$step)
df$action_id <- factor(df$action_id)
df$action_reference <- factor(df$action_reference)

# 1. most common first action
start <- df %>% filter(step==1)
table(start$action_id)
ggplot(data = start, aes(action_id)) + geom_bar()+
  labs(x= 'Action ID', y = 'Counts')+
  theme(axis.text=element_text(size=9),
        axis.ticks.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.x = element_text(angle = 90, hjust = 1))

# 2. common last action
highest <- df %>% group_by(session_id) %>% summarise(last = max(step))
df <- left_join(df,highest)
last <- df %>%filter(step==last)
ggplot(data = last, aes(action_id)) + geom_bar()+
  labs(x= 'Action ID', y = 'Counts')+
  theme(axis.text=element_text(size=9),
        axis.ticks.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.x = element_text(angle = 90, hjust = 1))

# 3. freq. dist.
ggplot(data = df, aes(action_id)) + geom_bar()+
  labs(x= 'Action ID', y = 'Counts')+
  theme(axis.text=element_text(size=9),
        axis.ticks.x=element_blank(),
        axis.ticks.y=element_blank(),
        axis.text.x = element_text(angle = 90, hjust = 1))


