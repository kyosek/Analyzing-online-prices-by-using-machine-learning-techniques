pricecat != "3" ~ 0))
weekly <- weekly %>%
mutate(cat531 =
case_when(category == "531" ~ 1,
category != "531" ~ 0)) %>%
mutate(cat1212 =
case_when(category == "1212" ~ 1,
category != "1212" ~ 0))%>%
mutate(week_2 =
case_when(weekofm == "2" ~ 1,
weekofm != "2" ~ 0))%>%
mutate(week_5 =
case_when(weekofm == "5" ~ 1,
weekofm != "5" ~ 0))%>%
mutate(Sep =
case_when(month == "September" ~ 1,
month != "September" ~ 0))%>%
mutate(pricecat_3 =
case_when(pricecat == "3" ~ 1,
pricecat != "3" ~ 0))
q()
library(lubridate)
weekly$weekofm <- ceiling(as.numeric(day(weekly$date)) / 7)
library(dplyr)
df <- df %>%
mutate(cat531 =
case_when(category == "531" ~ 1,
category != "531" ~ 0)) %>%
mutate(cat1212 =
case_when(category == "1212" ~ 1,
category != "1212" ~ 0))%>%
mutate(week_2 =
case_when(weekofm == "2" ~ 1,
weekofm != "2" ~ 0))%>%
mutate(week_5 =
case_when(weekofm == "5" ~ 1,
weekofm != "5" ~ 0))%>%
mutate(Sep =
case_when(month == "September" ~ 1,
month != "September" ~ 0))%>%
mutate(pricecat_3 =
case_when(pricecat == "3" ~ 1,
pricecat != "3" ~ 0))
table(cat531$event)
112972/1164130
table(weekly$event)
520882/1772923
model <- glm(event~duration+fullprice+weekofm+month+pricecat+category,
data=weekly,
family = binomial(link = "logit"))
summary(model)
model <- glm(event~duration+fullprice+factor(weekofm)+month+pricecat+category,
data=weekly,
family = binomial(link = "logit"))
summary(model)
library(aod)
library(ggplot2)
l <- cbind(0,1, -1)
wald.test(b = coef(model1), Sigma = vcov(model1),Terms = 78)
wald.test(b = coef(model), Sigma = vcov(model1),Terms = 78)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 78)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 70)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 60)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 65)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 63)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 62)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 61)
library(ggplot2)
ggplot(data = df, aes(x = fullprice)) +
geom_histogram(bins = 100) + xlim(0,100) +
labs(x = 'price', y = 'count')+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"))
ggplot(data = df, aes(x = fullprice)) +
geom_histogram(bins = 100) + xlim(0,100) +
labs(x = 'price', y = 'count')+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(dayfac) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=dayfac, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'day of a week', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Mon","Tue","Wed","Thu","Fri","Sat",
"Sun"))
library(dplyr)
df %>% group_by(dayfac) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=dayfac, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'day of a week', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Mon","Tue","Wed","Thu","Fri","Sat",
"Sun"))
df %>% group_by(day) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=day, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'day of a week', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Mon","Tue","Wed","Thu","Fri","Sat",
"Sun"))
df %>% group_by(weekofm) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=weekofm, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'week of a month', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("1st","2nd","3rd","4th","5th"))
df %>% group_by(month) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=month, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'month of a year', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec"))
df %>% group_by(season) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=season, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'season', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(pricecat) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=pricecat, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=10),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=8),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(#axis.text=element_text(size=8),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
class(df$category)
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(#axis.text=element_text(size=8),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(#axis.text=element_text(size=8),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(season) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=season, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'season', y = 'probability of price change')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(season) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=season, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'season', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(season) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=season, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'season', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=15),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(month) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=month, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=15),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec"))
df %>% group_by(month) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=month, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=15),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec"))
df %>% group_by(month) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=month, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=14),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec"))
df %>% group_by(month) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=month, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec"))
df %>% group_by(weekofm) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=weekofm, y=mean_event)) +
geom_bar(stat = "identity") +
labs(y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("1st","2nd","3rd","4th","5th"))
rm(model,test,train)
class(weekly$category)
model <- glm(event~duration+fullprice+factor(weekofm)+month+pricecat+
category,data=weekly,
family = binomial(link = "logit"))
summary(model)
rm(model,l)
rm(check)
q()
model <- glm(event~duration+fullprice+Cat531,data=weekly,
family = binomial(link = "logit"))
summary(model)
model <- glm(event~duration+fullprice+cat531,data=weekly,
family = binomial(link = "logit"))
summary(model)
library(dplyr)
cat531 <- df %>% filter(category == 531)
weekly <- weekly %>% mutate(cat531=
case_when(category=="531"~1,
category!="531"~0))
weekly <- weekly %>%
mutate(cat531 =
case_when(category == "531" ~ 1,
category != "531" ~ 0))
model <- glm(event~duration+fullprice+cat531,data=weekly,
family = binomial(link = "logit"))
summary(model)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 3)
library(aod)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 3)
wald.test(b = coef(model), Sigma = vcov(model),Terms = 4)
library(dplyr)
rm(model)
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
library(ggplot2)
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1))
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1))
df %>% group_by(pricecat) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=pricecat, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(pricecat) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=pricecat, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
#axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(pricecat) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=pricecat, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'price category', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=13),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
df %>% group_by(day) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=day, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'day of a week', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Mon","Tue","Wed","Thu","Fri","Sat",
"Sun"))
df %>% group_by(day) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=day, y=mean_event)) +
geom_bar(stat = "identity") +
labs(x = 'day of a week', y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=17),
axis.title=element_text(size=17,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())+
scale_x_discrete(labels=c("Mon","Tue","Wed","Thu","Fri","Sat",
"Sun"))
df$category <- as.numeric(df$category)
library(dplyr)
library(ggplot2)
df %>% group_by(category) %>%
summarise(mean_event = mean(event)) %>%
ggplot(aes(x=category, y=mean_event)) +
geom_bar(stat = "identity") +
labs( y = 'Probability')+
geom_abline(intercept = 0.0491, slope = 0,color="red")+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=15,face="bold"),
axis.title.x=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank())
head(df)
q()
